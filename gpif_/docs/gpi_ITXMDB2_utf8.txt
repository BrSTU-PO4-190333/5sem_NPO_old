      Н0
      ш1
      В60

.
                                - 1 -

                    Лабораторная работа                itxMdb2.txl
          Проектирование и создание экранных форм,
             выходных форм, меню в среде FoxPro
     ЦЕЛЬ РАБОТЫ.
     Приобретение навыков проектирования и создания экранных форм,
выходных форм и меню в среде СУБД FoxPro.
     ОСНОВНЫЕ ПОНЯТИЯ.
     Картотека - совокупность объектов  модели  (карточек)  одного
типа. Синонимы - справочник, файл, база данных.
     Экранная форма  -  отображение  на экране реквизитов карточки
объекта или  каких-либо других данных базы данных.
     Текст -  поле  на экранной форме с некоторым постоянным текс-
том.
     Отображаемое поле  - поле на экранной форме  для отображения
реквизита карточки.
     Редактируемое поле - поле на экранной форме для отображения и
корректировки (ввода) реквизита карточки.
     Переключатель - поле на экранной форме для отображения рекви-
зита типа ДА/НЕТ (1/0, [Х]/[ ])
     Установить поле  -  установка  переключателя  (см.выше)  в ДА
([х]) Синоним - установить переключатель
     Сбросить поле - установка переключателя (см.выше) в НЕТ ([ ])
Синоним - сбросить переключатель
     Выбрать поле - установить курсор мышки на поле и нажать  (ле-
вую) кнопку  мышки  (в некоторых случаях требуется быстрое двойное
нажатие кнопки мышки).
     Кнопка программного  вызова  -  поле,  выделенной на экранной
форме, при отработке на котором мышкой происходит вызов  некоторой
программы.
     Выходная форма - сформированный программным способом отчетный
документ. Синонимы - отчет, табуляграмма, форма, документ, запрос.
     Шаблон генерации выходной формы - специальное описание с ука-
заниями как формировать выходную форму. Синонимы - отчет.
     Запрос на  формирование выходной формы - специальное описание
способа формирования выходной формы(картотеки),  содержащее указа-
ние способа формирования промежуточного набора данных, шаблона ге-
нерации выходной формы и  указание  места  вывода  данных(выходной
формы). Синоним - запрос.
     Уровень отчета  -  уровни  иерархического расположения данных
картотеки после  сортировки согласно указанных реквизитов при опи-
сании шаблона генерации выходной формы.
     Специальные уровни отчета - место в выходной форме для разме-
щения специальной информции (нижние и верхние колонтитулы,и т.д.)
     ПОЛУЧЕННЫЕ НАВЫКИ.
     В результате  выполнения  лабораторной  работы студент должен
уметь создавать в среде СУБД Foxpro:
     - простые экранные формы;
     - типовые выходные  формы;
     - типовые меню.
     ВЫПОЛНЕНИЕ РАБОТЫ.
     1. Выбрать вариант задания согласно Приложения 1. Разработать
структуру базы  данных  (DBF) согласно выбраного задания.  Создать
рабочий каталог ISZ на диске указанном  преподавателем.  Загрузить
FoxPro для чего в каталоге FPD26 найти и запустить программу foxp-
ro(x).exe. При  запуске  foxprox выбрать пункт меню Proceed to the
Foxpro menu...  . Создать DBF в каталоге ISZ (при создании DBF пе-
рейти  в среде Foxpro в каталог ISZ !!!) и ввести в созданную базу

                                - 2 -

данных 15 записей (см. предыдущую лабораторную работу) .
     2. C использованием мышки  создать  экранную  форму  untitled
(непоименованная) (F10,  File,  Open, выбрать Type=Screen, выбрать
New).
     Нарисовать на  экране рамку (зафиксировать мышкой левый верх-
ний угол,  выбрать Screen,  выбрать Box,  "растянуть" мышкой рамку
(движение правого нижнего угла), отпустить кнопку мышки ).
     Отработать создание текста на экранной форме, например, в се-
редине рамки сделать надпись " Привет от Ф.И.О.СТУДЕНТА" (зафикси-
ровать мышкой  начало  текста (установить курсор мышки в требуемую
позицию и нажать кнопку  мышки), ввести текст, нажать Ввод ).
     Создать кнопку программного вызова "выход из экранной  формы"
(зафиксировать мышкой начало текста кнопки,  выбрать Screen,  выб-
рать Push Button, в поле Push button prompt ввести название кнопки
"ВЫХОД" ,  в поле Choose набрать m.end,  выбрать Valid, в поле для
ввода операций (переход с помощью мышки) набрать cancel, OK, OK).
     Установить процедуру  начального входа в экранную форму (выб-
рать Screen,  выбрать Screen Layout, выбрать Setup, Ok, в окне Un-
titled Setup  ввести и сохранить(выход по левому верхнему углу ок-
на) процедуру начальной установки
    close all
    clear
    select 1
    use имя_DBF_созданной_ранее_картотеки
    Сохранить untutled экран под именем FIO_s (здесь и  далее  FIO
означает  набор латинскими буквами первых букв ФИО студента) (выб-
рать File,  выбрать Save As,  набрать имя экранной формы в  нижнем
поле экрана, выбрать Save, Yes)
    Сгенерировать программный текст на выполнение  экранной  формы
(выбрать Program, выбрать Generate, выбрать Generate, Yes (при не-
обходимости) при запросе на сохранение измененного экрана).
     Запустить программу  вывода экранной формы FIO_s.spr (выбрать
Program, выбрать Do, указать курсором мышки программу FIO_s.SPR на
выполнение и дважды нажать кнопку мышки).
     По отработке  (появлению)  экрана выйти из него (выбрать поле
ВЫХОД).
     Отработать вызов экранной формы несколько раз.
     При возникновении проблемм обратиться к преподавателю.
     Выйти из среды Foxpro (выбрать File, выбрать Quit).
     3. Из экранной формы FIO_s создать новую экранную форму.
     Загрузить Foxpro (см.выше). Отработать выбор картотеки ( выб-
рать File, выбрать Open, выбрать Database, указать мышкой картоте-
ку (при необходимости перейти в каталог ISZ) , Ok) Загрузить экран
FIO (выбрать File, выбрать Open, выбрать Type=Screen, указать мыш-
кой  требуемый экран FIO,  нажать двыжды кнопку мышки),  сохранить
экранную форму под именем FIO_s1 (см.выше).
     Модифицировать экранную форму FIO_s1,  а именно, изменить раз-
мер рамки (отработать мышкой на рамке, Delete, создать новую рамку
(см.выше)), вставить текст КАРТОЧКА (см. выше), вставить 2 отобра-
жаемых поля (выбрать Screen, выбрать Field, выбрать <Get>, указать
отбражаемое поле картотеки в поле  Database  Field  с  последующим
двойным нажатием кнопки мышки, OK, выбрать ()Say, выбрать Refresh,
Ok), вставить отображаемое поле полученное в результате вычислений
(см.выше, но вместо выборки отображаемого поля картотеки указать в
поле <Say> вычислимое выражение,  например,  стомость х 10), вста-
вить 3 редактируемых поля (выбрать Screen,  выбрать Field, выбрать
<Get>, указать редактируемое поле картотеки в поле Database  Field

                                - 3 -

с последующим двойным нажатием кнопки мышки,  выбрать Valid и наб-
рать в появившемся окне SHOW GETS , OK, OK ). Отработать перемеще-
ние  полей по экрану (выбор мышкой и классическое перетаскивание).
Отработать удаление полей (выбор поля мышкой и Delete). Отработать
изменение размера  полей (выбор поля мышкой,  Enter,  Ctrl+пробел,
курсор вправо (или влево), Еnter).
     Сохранить полученную экранную форму  (выбрать  File,  выбрать
Save). Сгенерировать программный текст экранной формы (см. выше) и
отработать его на выполнение (см.выше).
     Из экранной  формы  FIO_s1  сделать  экранную  форму   FIO_s2
(см.выше).  Добавить  кнопку  программного вызова СЛЕДУЮЩАЯ ЗАПИСЬ
(см.выше) с вызовом программы
     skip
     show gets
     Добавить кнопку программного вызова ПРЕДЫДУЩАЯ ЗАПИСЬ с вызо-
вом программы
     skip -1
     show gets
     Добавить кнопку программного вызова ДОБАВИТЬ ЗАПИСЬ с вызовом
программы
     append
     show gets
     Добавить кнопку  программного вызова ПРОСМОТР КАРТОТЕКИ с вы-
зовом программы

  define window browse_xx ;
	from 0,1 to 24,79 ;
        nofloat none shadow

  activ window browse_xx

  browse normal  ledit;
     noappend nomenu ;
     window browse_xx ;
     title " картотека студента ФИО "

  release window browse_xx

  show gets

     Сохранить экранную  форму.  Отработать генерацию программного
текста экранной формы и его вызов (см.выше)
     Выйти из среды Foxpro.
     4. Создание линейной выходной формы (распечатка несортирован-
ной картотеки).
     Загрузить Foxpro.  Отработать выбор картотеки (выбрать File,
выбрать Open,  выбрать  Type=Database,  указать мышкой картотеку c
последующим двойным нажатием кнопки мышки).  Вставить в  картотеку
поле X1 (Numeric, 1) (см. предыдущую лабораторную работу). Это по-
ле будет использовано в качестве уровня 0 картотеки (вся  картоте-
ка).
     C использованием мышки создать отчет untitled  (непоименован-
ный) (выбрать File, Open, выбрать Type=Report, выбрать New).
     Определить уровень 0 отчета  (выбрать  Report,  выбрать  Data
Grouping,  выбрать <Add>,  выбрать <Group>,  указать поле X1 в ка-
честве переменой уровня в окне Field Name  c  последующим  двойным
нажатием кнопки мышки, OK, OK).

                                - 4 -

     Написать заголовок формы на уровне PgHead примерно следующего
вида (смысловая нагрузка шапки формы определяется заданием)

     БФ НИСЗ                                     ф.FIO_r
                  Платежная ведомость
     -----------------------------------------------------
     Цех| таб.N |   Фио         | сумма   |  подпись
     -----------------------------------------------------
     Написать на уровне 0/последняя запись ( └─X1 ) (отработка  по
последней записи картотеки) текст примерно следующего вида
               Всего
     =====================================================
     Указать на уровне Detail вывод полей картотеки согласно Ваше-
го задания  (зафиксировать  позицию  с помощью мышки,  выбрать Re-
port, Field,  выбрать <Expr...>, указать мышкой поле картотеки для
вывода  в  отчет  с  последующим  двойным  нажатием  кнопки мышки,
OK,OK).
     Сохранить шаблон для генерации формы (отчет) под именем FIO_r
(выбрать File, выбрать Save As, указать требуемое имя, выбрать Sa-
ve, при запросе сохранения среды выбрать Yes).
     Отработать предварительный  просмотр отчета (выбрать Report,
выбрать Page Preview,  просмотреть отчет).  Отработать перемещение
полей по экрану (выбор мышкой и классическое перетаскивание).  От-
работать удаление полей (выбор поля мышкой и Delete).
     Сохранить отчет после модификации (выбрать File,  выбрать Sa-
ve).
     5. Создание запроса на формирование выходной формы.
     C использованием мышки создать запрос untitled  (непоименован-
ный) (выбрать File, выбрать Open, выбрать Type=Query, выбрать New).
     Указать выбираемую для запроса картотеку. Указать поля карто-
теки,  выбираемые  для запроса (выбрать Select field,  указать все
поля (All) или же выбрать с помощью мышки в окне с указанием полей
только  необходимые).  Указать сортировку картотеки (выбрать Order
by,  указать поля сортировки). Указать вид выходной формы (выбрать
Output to = Report/Label). Указать параметры запроса выходной фор-
мы (выбрать Option,  установить ()Report, установить и указать имя
ранее созданного шаблона для генерации выходной формы , установить
Preview report, OK). После проверки выходной формы (выбрать Do Qu-
ery)  установить параметры выходной формы для вывода в файл ( выб-
рать Option,  сбросить Preview report,  установить вывод в файл To
file  и  указать  имя  файла для вывода выходной формы) Замечание:
возможен прямой вывод на принтер,  который в  рамках  лабораторной
работы  не  отрабатывается.  Сохранить созданный запрос под именем
FIO_q (см.выше).
     Отработать запрос  на  формирование  выходной  формы (выбрать
Program,  выбрать Do,  указать программу на выполнение, выбрать Do
(или двойное нажатие кнопки мышки на указанной программе). Посмот-
реть сформированную выходную форму (выбрать  File,  выбрать  Open,
выбрать Type=File, указать мышкой требуемый файл с выходной формой
указанный ранее в запросе на формирование формы).
     Загрузить запрос  FIO_q  (см.выше) и сохранить его под именем
FIO_q1. Указать новые поля для сортировки картотеки и указать  но-
вое имя выходного файла с выходной формой (см.выше). Указать усло-
вие для выборки записей из картотеки (выбрать поле  в  окне  Field
Name, выбрать условие Like, указать константу для сравнения в окне
Example). Сохранить запрос (см.выше) Отработать получение и  прос-
мотр выходной формы (см.выше).

                                - 5 -

     Поэкспериментировать с заданием условия на выборку записей из
картотеки.
     6.  Создание меню.
     C использованием мышки создать меню untitled  (непоименован-
ное) (выбрать File, выбрать Open, выбрать Type=Menu, выбрать New).
     В поле  Prompt (1-я строка) набрать текст ЭКРАНЫ.  Установить
Submenu.
     В поле  Prompt (2-я строка) набрать текст ФОРМЫ.  Установить
Submenu.
     В поле  Prompt (3-я строка) набрать текст ВЫХОД.  Установить
Command. Набрать quit (это указание на выход из приложения)
     Выбрать <Create> 1-ой строки.
     В поле Prompt (1-я строка) набрать текст ЭКРАН_0.  Установить
Command. Набрать do FIO_s.spr (это указание вызвать на  выполнение
экранную форму FIO_s).
     В поле Prompt (2-я строка) набрать текст ЭКРАН_1.  Установить
Command. Набрать do FIO_s1.spr.
     В поле Prompt (3-я строка) набрать текст ЭКРАН_2.  Установить
Command. Набрать do FIO_s2.spr.
     В окне расположенном в правом верхнем углу (указатель
текущего уровня меню) выбрать Menu Bar.
     Выбрать <Create> 2-ой строки.
     В поле Prompt (1-я строка) набрать текст Форма_0.  Установить
Command. Набрать do FIO_q.qpr (это указание вызвать на  выполнение
запрос на получение выходной форму FIO_q ).
     В поле  Prompt  (2-я  строка) набрать текст Форма_0_просмотр.
Установить Command.  Набрать modify file FIO_q.txt  (это  указание
вызвать текстовый редактор для просмотра файла FIO_q.txt).
     В поле Prompt (3-я строка) набрать \-.
     В поле Prompt (4-я строка) набрать текст Форма_1.  Установить
Command. Набрать do FIO_q1.qpr (это указание вызвать на выполнение
запрос на получение выходной форму FIO_q1 ).
     В поле Prompt (5-я строка)  набрать  текст  Форма_1_просмотр.
Установить  Command.  Набрать modify file FIO_q1.txt (это указание
вызвать текстовый редактор для просмотра файла FIO_q1.txt).
     Выполнить предварительный просмотр меню (выбрать <Try it>)
     Сохранить меню под имение FIO_m (выбрать File,  выбрать  Save
As, указать имя, выбрать Save).
     Сгенерировать программный текст на запуск меню (выбрать Prog-
ram,  выбрать Generate,  выбрать Generate, Yes (при необходимости)
при запросе на сохранение измененного определения меню).
     Запустить меню FIO_m.mpr (выбрать Program,  выбрать Do,  ука-
зать курсором мышки программу FIO_m.mpr  и  дважды  нажать  кнопку
мышки).

.
                                - 6 -


------------------------------------------------------------------
               Выбор варианта                         Приложение 1.

Вариант               1   2   3   4   5   6   7   8   9  10
───────────────────────────────────────────────────────────────
Фамилия начинается    Ц   У   К   Е   Н   Г   Ш   Щ   З   Х
    на букву          Ф   В   А   П   Р   О   Л   Д   Ж   Э
                      Я   Ч   С   М   И   Т   Б   Ю
───────────────────────────────────────────────────────────────
Создаваемая картотека │   │   │   │   │   │   │   │   │   │
                      │   │   │   │   │   │   │   │   │   Банки
                      │   │   │   │   │   │   │   │   Накладные
                      │   │   │   │   │   │   │   Подотчетные лица
                      │   │   │   │   │   │   Табельные(зарплата)
                      │   │   │   │   │   Материалы(склад)
                      │   │   │   │   Платежные поручения
                      │   │   │   Виды оплат(зарплата)
                      │   │   Организации(перечисления по банку)
                      │   Организации(почтовые отправки)
                      Постоянные начисления/удержания(зарплата)



